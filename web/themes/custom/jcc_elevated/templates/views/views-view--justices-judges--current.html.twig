{{ attach_library("jcc_storybook/Icon") }}
{{ attach_library("jcc_storybook/Section") }}
{{ attach_library("jcc_storybook/ProfileCard") }}
{{ attach_library("jcc_storybook/ProfileCards") }}

{% set cards = [] %}
{% for key, value in profiles %}
  {% set division = key %}
  {% set cards %}
    {% for profile in value %}
      {% set image %}
        {% set media = profile.image.field_media_image.entity.uri.value %}
        {% if media %}
          <img src="{{ file_url(media) }}">
        {% else %}
          {% include "@atoms/Icon/Icon.twig" with {
            icon: 'line-circle-person',
            color: 'base',
            icon_path: ' ',
          } %}
        {% endif %}
      {% endset %}
      {% include "@molecules/ProfileCard/ProfileCard.twig" with {
        image:  image|raw,
        name: profile.name,
        title: profile.title,
        content: profile.content,
        url: profile.url,
      } %}
    {% endfor %}
  {% endset %}

  {% include "@organisms/ProfileCards/ProfileCards.twig" with {
    variant: 'multiple',
    heading: division != 'Unassigned' ? division : '',
    sub_component_data: [cards],
  } %}
{% endfor %}
