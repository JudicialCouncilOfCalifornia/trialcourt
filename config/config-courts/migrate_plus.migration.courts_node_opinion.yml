uuid: e347d6ae-7773-48eb-a28b-3ae1594a8ac8
langcode: en
status: true
dependencies: {  }
id: courts_node_opinion
class: null
field_plugin_method: null
cck_plugin_method: null
migration_tags:
  - courts
  - node
  - opinion
migration_group: courts
label: 'Courts: Import opinions, media attachments, and web citings'
source:
  plugin: url
  data_fetcher_plugin: http
  data_parser_plugin: xml
  urls: ''
  item_selector: /root/opinion
  fields:
    -
      name: type
      label: 'Opinion Type'
      selector: type
    -
      name: posted
      label: 'Posted Date'
      selector: posted
    -
      name: case
      label: Case
      selector: case
    -
      name: tags
      label: 'Match Media by Case Name'
      selector: case
    -
      name: title
      label: Title
      selector: title
    -
      name: related
      label: 'Related Cases'
      selector: related
    -
      name: granted
      label: 'Review Granted'
      selector: granted
    -
      name: attachments
      label: Attachments
      selector: attachments
    -
      name: citings
      label: 'Web Page Citings'
      selector: citings
  ids:
    case:
      type: string
process:
  status:
    plugin: default_value
    default_value: true
  moderation_state:
    plugin: default_value
    default_value: published
  pseudo_file_path:
    plugin: path_from_url
    source: url
  uid:
    plugin: default_value
    default_value: 1
  title:
    -
      plugin: get
      source: title
    -
      plugin: default_value
      default_value: TITLE
  path/pathauto:
    plugin: default_value
    default_value: 1
  field_opinion_type:
    -
      plugin: entity_generate
      source: type
      entity_type: taxonomy_term
      value_key: name
      bundle_key: vid
      bundle: opinion_type
  field_opinion_source:
    -
      plugin: substr
      source: case
      length: 1
    -
      plugin: static_map
      map:
        '': ''
        S: 'Supreme Court'
        A: '1st District Court of Appeal'
        B: '2nd District Court of Appeal'
        C: '3rd District Court of Appeal'
        D: '4th District Court of Appeal, Division One'
        E: '4th District Court of Appeal, Division Two'
        F: '4th District Court of Appeal, Division Three'
        G: '5th District Court of Appeal'
        H: '6th District Court of Appeal'
        J: 'Appellate Division'
      bypass: true
    -
      plugin: default_value
    -
      plugin: entity_generate
      entity_type: taxonomy_term
      value_key: name
      bundle_key: vid
      bundle: opinion_source
  field_date/value:
    -
      plugin: format_date
      source: posted
      from_format: U
      to_format: Y-m-d
  field_case_number_plain: case
  field_related_cases_plain: related
  field_review_granted:
    plugin: evaluate_condition
    source: granted
    condition:
      plugin: equals
      value: '1'
  field_media_file_multiple:
    -
      plugin: jcc_opinion_files
      source: case
    -
      plugin: multiple_values
    -
      plugin: migration_lookup
      migration: courts_media_opinion
    -
      plugin: skip_on_empty
      method: process
      message: 'No media to attach to opinion.'
  field_web_page_citings:
    -
      plugin: explode
      source: citings
      delimiter: ','
    -
      plugin: callback
      callable: trim
    -
      plugin: multiple_values
    -
      plugin: migration_lookup
      migration: courts_media_opinion
    -
      plugin: jcc_media_path
    -
      plugin: link_uri
    -
      plugin: skip_on_empty
      method: process
      message: 'No media to attach to opinion.'
destination:
  plugin: 'entity:node'
  default_bundle: opinion
migration_dependencies:
  optional:
    - courts_media_opinion
