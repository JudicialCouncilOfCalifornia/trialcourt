uuid: 9a35390f-86aa-4c68-85a7-8d202ed5aafb
langcode: en
status: true
dependencies: {  }
id: supremecourt_node_opinion_published
class: null
field_plugin_method: null
cck_plugin_method: null
migration_tags:
  - supremecourt
  - node
  - opinion
  - published
migration_group: supremecourt
label: 'Opinion: Import published/citable from legacy index'
source:
  plugin: csv
  url: 'https://www4.courtinfo.ca.gov/mel_test/index.txt'
  delimiter: "\t"
  header_offset: null
  fields:
    -
      name: posted
      label: 'Posted Date'
    -
      name: author
      label: Author
    -
      name: case
      label: Case
    -
      name: title
      label: Title
    -
      name: related
      label: 'Related Cases'
    -
      name: summary
      label: Summary
  ids:
    - posted
    - case
process:
  field_opinion_source:
    -
      plugin: skip_on_condition
      method: row
      source: case
      condition:
        plugin: not:matches
        regex: '/^S/'
    -
      plugin: substr
      length: 1
    -
      plugin: static_map
      map:
        '': ''
        S: 'Supreme Court'
      bypass: true
    -
      plugin: default_value
    -
      plugin: entity_generate
      entity_type: taxonomy_term
      value_key: name
      bundle_key: vid
      bundle: opinion_source
  status:
    plugin: default_value
    default_value: true
  moderation_state:
    plugin: default_value
    default_value: published
  uid:
    plugin: default_value
    default_value: 1
  title:
    -
      plugin: jcc_convert_encoding
      source: title
      from: Windows-1252
      to: UTF-8
    -
      plugin: default_value
      default_value: TITLE
  path/pathauto:
    plugin: default_value
    default_value: 1
  field_opinion_type:
    -
      plugin: default_value
      default_value: Published
    -
      plugin: entity_generate
      entity_type: taxonomy_term
      value_key: name
      bundle_key: vid
      bundle: opinion_type
  field_date_time/value:
    -
      plugin: format_date
      source: posted
      from_format: U
      to_format: 'Y-m-d\TH:i:s'
  field_case_number_plain:
    -
      plugin: get
      source: case
    -
      plugin: skip_on_condition
      condition: is_null
      method: process
      message: 'Case number could not be determined.'
  field_related_cases_plain:
    -
      plugin: get
      source: related
    -
      plugin: skip_on_empty
      method: process
      message: 'No related cases.'
  field_summary/value:
    -
      plugin: get
      source: summary
    -
      plugin: skip_on_condition
      condition: is_null
      method: process
      message: 'No summary.'
  field_summary/format:
    -
      plugin: skip_on_condition
      condition: is_null
      method: process
      source: summary
      message: 'No summary format needed.'
    -
      plugin: default_value
      default_value: minimal
destination:
  plugin: 'entity:node'
  default_bundle: opinion
migration_dependencies: null
